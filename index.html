<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The SNDBX - Online services</title>
  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
  <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
  <style>
    :root { --bg-color: #f5f5f5; --text-color: #000; --card-bg: #fff; }
    body[data-theme="dark"] {
      --bg-color: #121212; 
      --text-color: #eee; 
      --card-bg: #1e1e1e; 
    }
    html, body {height:100%; margin:0; font-family:Roboto,sans-serif; background:var(--bg-color); color:var(--text-color); transition:0.3s;}
    #topButtons {position:fixed; top:16px; right:24px; display:flex; gap:12px; z-index:1001;}
    #topButtons button {border:1px solid var(--text-color); background:transparent; color:var(--text-color); padding:8px 14px; border-radius:6px; cursor:pointer;}
    .main-content {display:flex; flex-direction:column; align-items:center; min-height:60vh; padding-top:60px; gap:40px; background:var(--bg-color);}
    .services-row {display:flex; flex-wrap:wrap; justify-content:center; gap:24px;}
    .service-card {position:relative; width:250px; height:250px; background:var(--card-bg); border-radius:8px; box-shadow:0 4px 8px rgba(0,0,0,0.15); display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; color:var(--text-color); transition:transform 0.2s; cursor:pointer;}
    .service-card:hover {transform:translateY(-5px);}
    .service-title {font-size:20px; font-weight:500; margin:12px 0;}
    .service-image {width:60%; height:150px; object-fit:cover; border-radius:4px;}
    .service-description {font-size:14px; margin-top:auto;}
    .add-card {font-size:100px; color:#888; display:flex; justify-content:center; align-items:center; height:100%;}
    .menu-btn {position:absolute; top:10px; right:10px; font-size:24px; cursor:pointer;}
    .context-menu {position:absolute; top:40px; right:10px; background:var(--card-bg); border:1px solid #555; border-radius:5px; display:none; z-index:9999;}
    .context-menu button {display:block; width:100%; padding:8px; border:none; background:none; color:var(--text-color); text-align:left; cursor:pointer;}
    .context-menu button:hover {background:#eee;}
    #addModal, #subscribeModal, #settingsModal, #editModal {position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); display:none; align-items:center; justify-content:center;}
    .modal-content {position:relative; background:var(--card-bg); padding:30px; border-radius:12px; width:400px; color:var(--text-color); box-shadow: 0 0 15px rgba(0,0,0,0.5);}
    .modal-content input, .modal-content textarea {width:100%; margin:8px 0; padding:10px; background:var(--bg-color); color:var(--text-color); border:1px solid #555; border-radius:5px;}
    .modal-content button {margin-top:12px; padding:12px 20px; border:none; background:#3f51b5; color:#fff; border-radius:4px; cursor:pointer; font-size:16px;}
    .modal-close {position:absolute; top:10px; right:15px; font-size:24px; cursor:pointer;}
    .toast {visibility:hidden;min-width:250px;background:#4caf50;color:white;text-align:center;border-radius:8px;padding:12px;position:fixed;z-index:999;left:50%;bottom:30px;transform:translateX(-50%);font-size:16px;opacity:0;transition:opacity 0.5s,visibility 0.5s;}
    .toast.show {visibility:visible;opacity:1;}
  </style>
</head>
<body>

<div id="topButtons">
  <button id="subscribeBtn">üìß Subscribe</button>
  <button id="settingsBtn">‚öôÔ∏è Settings</button>
  <button id="themeToggle">üåó Theme</button>
</div>

<div class="main-content">
  <div id="serviceContainer" class="services-row"></div>
</div>

<div id="addModal">
  <div class="modal-content">
    <div class="modal-close" onclick="closeModal('addModal')">&times;</div>
    <h3>Add New Shortcut</h3>
    <input id="newTitle" placeholder="Title">
    <textarea id="newDesc" placeholder="Description"></textarea>
    <input id="newUrl" placeholder="URL">
    <input id="newImgLink" placeholder="Image URL (optional)">
    <input id="newImgFile" type="file" accept="image/*">
    <button onclick="saveShortcut()">Save</button>
  </div>
</div>

<div id="editModal">
  <div class="modal-content">
    <div class="modal-close" onclick="closeModal('editModal')">&times;</div>
    <h3>Edit Shortcut</h3>
    <input id="editTitle" placeholder="Title">
    <textarea id="editDesc" placeholder="Description"></textarea>
    <input id="editUrl" placeholder="URL">
    <input id="editImgLink" placeholder="Image URL (optional)">
    <button onclick="updateShortcut()">Update</button>
  </div>
</div>

<div id="subscribeModal">
  <div class="modal-content">
    <div class="modal-close" onclick="closeModal('subscribeModal')">&times;</div>
    <h3>Subscribe to updates</h3>
    <input id="emailInput" placeholder="Your email address">
    <button onclick="saveSubscription()">Subscribe</button>
  </div>
</div>

<div id="settingsModal">
  <div class="modal-content">
    <div class="modal-close" onclick="closeModal('settingsModal')">&times;</div>
    <h3>Settings</h3>
    <button onclick="exportSettings()">Export Settings</button>
    <input type="file" id="importFile" style="margin-top:10px">
    <button onclick="importSettings()">Import Settings</button>
  </div>
</div>

<div id="successToast" class="toast">‚úÖ Subscribed successfully!</div>

<script>
  let editIndex = -1;
  const themeBtn = document.getElementById('themeToggle');
  function applyTheme(theme){ document.body.dataset.theme=theme; localStorage.setItem('theme', theme); themeBtn.textContent = theme==='dark'?'‚òÄÔ∏è Theme':'üåó Theme'; }
  themeBtn.onclick = () => applyTheme(document.body.dataset.theme==='dark'?'light':'dark');
  applyTheme(localStorage.getItem('theme') || 'light');

  const services = [
    { title:"Cloud tasks", img:"/img/cloudtask.png", desc:"Create tasks and save them in the cloud.", url:"services/login.html" },
    { title:"Csv generator", img:"/img/csv.png", desc:"Generate CSV files using templates.", url:"services/filegenerator.html" },
    { title:"API online", img:"/img/api.png", desc:"Online API tester.", url:"services/apitester.html" },
    { title:"Converter (TXT/JSON/YAML)", img:"/img/converter.png", desc:"Convert formats easily.", url:"services/converter.html" },
    { title:"Create file with weight", img:"/img/weight.png", desc:"Create files with custom size.", url:"services/weightgenerator.html" },
    { title:"Temp email receiver", img:"/img/letter.png", desc:"Temporary email.", url:"services/email.html" },
    { title:"Proxy list", img:"/img/proxyimg.png", desc:"Proxy servers list.", url:"services/proxylist.html" },
    { title:"What's new", img:"/img/appnews.png", desc:"Latest updates.", url:"services/newspage.html" }
  ];

  const customKey = 'customShortcuts';
  function getCustom() { return JSON.parse(localStorage.getItem(customKey)||'[]'); }

  function render() {
    const container = document.getElementById('serviceContainer');
    container.innerHTML = '';
    services.forEach(item => {
      const card = document.createElement('div');
      card.className = 'service-card';
      card.onclick = () => window.location.href=item.url;
      card.innerHTML = `<div class="service-title">${item.title}</div>
                        <img class="service-image" src="${item.img}">
                        <div class="service-description">${item.desc}</div>`;
      container.appendChild(card);
    });

    getCustom().forEach((item, index) => {
      const card = document.createElement('div');
      card.className = 'service-card';
      card.innerHTML = `<div class="menu-btn">‚ãÆ</div>
                        <div class="context-menu">
                          <button onclick="startEdit(${index})">Edit</button>
                          <button onclick="deleteShortcut(${index})">Delete</button>
                        </div>
                        <div class="service-title">${item.title}</div>
                        <img class="service-image" src="${item.img}">
                        <div class="service-description">${item.desc}</div>`;
      card.onclick = () => window.open(item.url, '_blank');
      container.appendChild(card);
    });

    const addCard = document.createElement('div');
    addCard.className = 'service-card';
    addCard.innerHTML = `<div class="add-card">+</div>`;
    addCard.onclick = () => document.getElementById('addModal').style.display='flex';
    container.appendChild(addCard);

    document.querySelectorAll('.menu-btn').forEach(btn => {
      btn.onclick = e => {
        e.stopPropagation();
        document.querySelectorAll('.context-menu').forEach(menu => menu.style.display='none');
        btn.nextElementSibling.style.display = 'block';
      }
    });

    window.onclick = () => document.querySelectorAll('.context-menu').forEach(menu => menu.style.display='none');
  }

  function startEdit(index) {
    const custom = getCustom();
    const item = custom[index];
    editIndex = index;
    document.getElementById('editTitle').value = item.title;
    document.getElementById('editDesc').value = item.desc;
    document.getElementById('editUrl').value = item.url;
    document.getElementById('editImgLink').value = item.img;
    document.getElementById('editModal').style.display='flex';
  }

  function updateShortcut() {
    const custom = getCustom();
    custom[editIndex] = {
      title: document.getElementById('editTitle').value,
      desc: document.getElementById('editDesc').value,
      url: document.getElementById('editUrl').value,
      img: document.getElementById('editImgLink').value
    };
    localStorage.setItem(customKey, JSON.stringify(custom));
    closeModal('editModal');
    render();
  }

  function deleteShortcut(index) {
    if(confirm("Are you sure?")){
      const custom = getCustom();
      custom.splice(index, 1);
      localStorage.setItem(customKey, JSON.stringify(custom));
      render();
    }
  }

  function saveShortcut() {
    const title = document.getElementById('newTitle').value.trim();
    const desc = document.getElementById('newDesc').value.trim();
    const url = document.getElementById('newUrl').value.trim();
    const imgLink = document.getElementById('newImgLink').value.trim();
    const imgFile = document.getElementById('newImgFile').files[0];

    if (!title || !url) return alert('Title and URL are required');

    if (imgFile) {
      const reader = new FileReader();
      reader.onload = function(e) {
        resizeImage(e.target.result, 256, 256, function(resizedDataUrl) {
          saveShortcutToStorage(title, desc, url, resizedDataUrl);
        });
      }
      reader.readAsDataURL(imgFile);
    } else {
      saveShortcutToStorage(title, desc, url, imgLink || '/img/default.png');
    }
  }

  function resizeImage(dataUrl, maxW, maxH, callback) {
    const img = new Image();
    img.onload = function() {
      let ratio = Math.min(maxW / img.width, maxH / img.height, 1);
      let canvas = document.createElement('canvas');
      canvas.width = img.width * ratio;
      canvas.height = img.height * ratio;
      let ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      callback(canvas.toDataURL('image/png', 0.8));
    }
    img.src = dataUrl;
  }

  function saveShortcutToStorage(title, desc, url, img) {
    const custom = getCustom();
    custom.push({title, desc, url, img});
    localStorage.setItem(customKey, JSON.stringify(custom));
    closeModal('addModal');
    render();
  }

  function saveSubscription() {
    const email = document.getElementById('emailInput').value.trim();
    if (!email) return;
    localStorage.setItem('subscriptionEmail', email);
    closeModal('subscribeModal');
    document.getElementById('successToast').classList.add('show');
    setTimeout(()=>{document.getElementById('successToast').classList.remove('show')}, 3000);
  }

  function exportSettings() {
    const data = JSON.stringify(getCustom());
    const blob = new Blob([data], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'shortcuts-backup.json';
    a.click();
    URL.revokeObjectURL(url);
  }

  function importSettings() {
    const file = document.getElementById('importFile').files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const data = JSON.parse(e.target.result);
        if (Array.isArray(data)) {
          localStorage.setItem(customKey, JSON.stringify(data));
          closeModal('settingsModal');
          render();
        } else {
          alert("Invalid file format");
        }
      } catch { alert("Error reading file"); }
    }
    reader.readAsText(file);
  }

  document.getElementById('subscribeBtn').onclick = () => document.getElementById('subscribeModal').style.display='flex';
  document.getElementById('settingsBtn').onclick = () => document.getElementById('settingsModal').style.display='flex';

  function closeModal(id) { document.getElementById(id).style.display='none'; clearFields(id); }
  function clearFields(id) {
    if (id==='addModal') {
      document.getElementById('newTitle').value='';
      document.getElementById('newDesc').value='';
      document.getElementById('newUrl').value='';
      document.getElementById('newImgLink').value='';
      document.getElementById('newImgFile').value='';
    } else if (id==='editModal') {
      document.getElementById('editTitle').value='';
      document.getElementById('editDesc').value='';
      document.getElementById('editUrl').value='';
      document.getElementById('editImgLink').value='';
    } else if (id==='subscribeModal') {
      document.getElementById('emailInput').value='';
    } else if (id==='settingsModal') {
      document.getElementById('importFile').value='';
    }
  }

  render();
</script>
</body>
</
